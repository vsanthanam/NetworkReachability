{"primaryContentSections":[{"kind":"content","content":[{"text":"Overview","type":"heading","level":2,"anchor":"Overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The easiest way to use a "},{"type":"reference","identifier":"doc:\/\/NetworkReachability\/documentation\/NetworkReachability\/NetworkMonitor","isActive":true},{"type":"text","text":" is to initialize an instance and retain it memory."},{"text":" ","type":"text"},{"type":"text","text":"From there you can access the "},{"type":"codeVoice","code":"currentPath"},{"text":" property whenever you need to know the last known network path.","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["import Network","import NetworkReachability","","let monitor = NetworkMonitor()","let path = monitor.currentPath"]},{"type":"paragraph","inlineContent":[{"text":"This synchronous API is easy to use, but ","type":"text"},{"type":"codeVoice","code":"currentPath"},{"text":" isn’t always up-to-date and is best used when a monitor instance has been retained in memory for some time. As such, it will be insufficient for many use cases and is not recommended.","type":"text"}]},{"inlineContent":[{"type":"text","text":"Instead, "},{"type":"reference","isActive":true,"identifier":"doc:\/\/NetworkReachability\/documentation\/NetworkReachability\/NetworkMonitor"},{"text":" offers a variety of asynchronous APIs for both single value retrieval as well as constant value observation that are gauranteed to offer up-to-date values.","type":"text"}],"type":"paragraph"},{"text":"Retrieving the current network path","level":3,"type":"heading","anchor":"Retrieving-the-current-network-path"},{"type":"paragraph","inlineContent":[{"isActive":true,"type":"reference","identifier":"doc:\/\/NetworkReachability\/documentation\/NetworkReachability\/NetworkMonitor"},{"text":" allows you to retrieve the last known network path using two asyncronous APIs. Unlike the synchronous API described above which provides values that may or may not be up to date, the asynchronous APIs gaurantee you access to an up-to-date value.","type":"text"}]},{"anchor":"Closures","type":"heading","text":"Closures","level":5},{"inlineContent":[{"type":"text","text":"To asynchronously retrieve the last known network path, you can use the "},{"code":"networkPath(completionHandler:)","type":"codeVoice"},{"type":"text","text":" static method. The provided closure will be executed exactly once."}],"type":"paragraph"},{"code":["import Network","import NetworkReachability","","func updateReachability() {","    NetworkMonitor.networkPath(completionHandler: { (path: NWPath) in ","        \/\/ Do something with `path`","    })","}"],"type":"codeListing","syntax":"swift"},{"type":"aside","name":"Important","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":""},{"type":"codeVoice","code":"completionHandler"},{"type":"text","text":" is always called in the main thread."}]}],"style":"important"},{"anchor":"Swift-Concurrency","level":5,"type":"heading","text":"Swift Concurrency"},{"type":"paragraph","inlineContent":[{"type":"text","text":"You can also retrieve the last known network path using Swift Concurrency via the "},{"type":"codeVoice","code":"networkPath"},{"type":"text","text":" static property."}]},{"code":["import Network","import NetworkReachability","","func updateReachability() {","    Task {","        let path = await NetworkMonitor.networkPath","        \/\/ Do something with `path`","    }","}"],"type":"codeListing","syntax":"swift"},{"name":"Note","style":"note","content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"This API requires iOS 13, macOS 10.15, tvOS 13, or watchOS 6"}]}],"type":"aside"},{"text":"Observing network path updates","type":"heading","level":3,"anchor":"Observing-network-path-updates"},{"inlineContent":[{"type":"text","text":"If you need to observe all network path changes, "},{"identifier":"doc:\/\/NetworkReachability\/documentation\/NetworkReachability\/NetworkMonitor","type":"reference","isActive":true},{"type":"text","text":" provides several asynchronous APIs that will allow you to integrate network path data into any existing pipeline"}],"type":"paragraph"},{"level":5,"text":"Closures","anchor":"Closures","type":"heading"},{"inlineContent":[{"type":"text","text":"You can use a closure to observe network path updates over time. You can pass in the closure on initialization, or add one later using the "},{"type":"codeVoice","code":"updateHandler"},{"text":" property.","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["import Network","import NetworkReachability","","final class MyClass {","","    var monitor: NetworkMonitor?","","    func startMonitoring() {","        stopMonitoring()","        monitor = NetworkMonitor(updateHandler: { (monitor: NetworkMonitor, path: NWPath) in","            \/\/ Do something with `monitor` or `path`","        })","    }","","    func stopMonitoring() {","        monitor = nil","    }","","}"],"type":"codeListing"},{"content":[{"type":"paragraph","inlineContent":[{"text":"By default, instances of ","type":"text"},{"identifier":"doc:\/\/NetworkReachability\/documentation\/NetworkReachability\/NetworkMonitor","isActive":true,"type":"reference"},{"text":" always call their update handlers on the main thread. You can change this behavior by setting the monitor’s ","type":"text"},{"type":"codeVoice","code":".updateQueue"},{"type":"text","text":" property."}]}],"name":"Important","style":"important","type":"aside"},{"anchor":"Swift-Concurrency","level":5,"text":"Swift Concurrency","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"You can use an ","type":"text"},{"type":"codeVoice","code":"AsyncSequence"},{"text":" to observe network path updates over time using Swift Concurrency","type":"text"}]},{"code":["import Network","import NetworkReachability","","final class MyClass {","    ","    var monitorTask: Task?","","    func startObserving() {","        stopObserving()","        monitorTask = Task {","            for await path in NetworkMonitor.networkMonitorUpdates {","                \/\/ Do something with `path`","            }","        }","    }","","    func startObserving() {","        monitorTask?.cancel()","        monitorTask = nil","    }","}"],"type":"codeListing","syntax":"swift"},{"type":"aside","style":"note","name":"Note","content":[{"inlineContent":[{"text":"This API requires iOS 13, macOS 10.15, tvOS 13, or watchOS 6","type":"text"}],"type":"paragraph"}]},{"type":"heading","level":5,"text":"Delegation","anchor":"Delegation"},{"type":"paragraph","inlineContent":[{"text":"You can use ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/NetworkReachability\/documentation\/NetworkReachability\/NetworkMonitorDelegate"},{"text":" to recieve callbacks when the network path changes. You can pass in a delegate object when the monitor is initialized, or you can assign one later.","type":"text"}]},{"syntax":"swift","code":["import Network","import NetworkReachability","","final class MyClass: NetworkMonitorDelegate {","","    var monitor: NetworkMonitor?","","    func startMonitoring() {","        stopMonitoring()","        monitor = NetworkMonitor(delegate: self)","    }","","    func stopMonitoring() {","        monitor = nil","    }","","    \/\/ MARK: - NetworkMonitorDelegate","","    func networkMonitor(_ monitor: NetworkMonitor, didUpdateNetworkPath networkPath: NWPath) {","        \/\/ Do something with `networkPath`","    }","","}"],"type":"codeListing"},{"content":[{"inlineContent":[{"type":"text","text":"By default, instances of "},{"identifier":"doc:\/\/NetworkReachability\/documentation\/NetworkReachability\/NetworkMonitor","isActive":true,"type":"reference"},{"type":"text","text":" always call execute their delegate callbacks on the main thread. You can change this behavior by setting the monitor’s "},{"type":"codeVoice","code":".updateQueue"},{"type":"text","text":" property."}],"type":"paragraph"}],"name":"Important","style":"important","type":"aside"},{"anchor":"NotificationCenter","level":5,"type":"heading","text":"NotificationCenter"},{"inlineContent":[{"text":"If you have retained an instance of ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/NetworkReachability\/documentation\/NetworkReachability\/NetworkMonitor"},{"text":" in memory, but do not have access to it in the part of your code that needs network path updates, you can","type":"text"},{"text":" ","type":"text"},{"text":"observe network path changes by observing notifications with the name ","type":"text"},{"code":"Notification.Name.networkPathChanged","type":"codeVoice"},{"type":"text","text":" on the default notification center. The notification’s "},{"code":".object","type":"codeVoice"},{"type":"text","text":" property will contain the "},{"isActive":true,"type":"reference","identifier":"doc:\/\/NetworkReachability\/documentation\/NetworkReachability\/NetworkMonitor"},{"text":". From there, you can use ","type":"text"},{"type":"codeVoice","code":"currentPath"},{"type":"text","text":" property of the monitor, which you now know will be up-to-date thanks to the notification."}],"type":"paragraph"},{"code":["import Foundation","import Network","import NetworkReachability","","final class MyClass {","","    var monitor: NetworkMonitor?","","    func startMonitoring() {","        stopMonitoring()","        NotificationCenter.default.addObserver(self, selector: #selector(handleUpdate:), name: .networkPathChanged)","        monitor = NetworkMonitor()","    }","","    func stopMonitoring() {","        monitor = nil","        NotificationCenter.default.removeObserver(self, name: .networkPathChanged)","    }","","    @objc","    func handleUpdate(_ notification: Notification) {","        guard let monitor = notification.object as? NetworkMonitor else {","            return","        }","        let path = monitor.currentPath","        \/\/ Do something with `path`","    }","","    deinit {","        NotificationCenter.default.removeObserver(self, name: .networkPathChanged)","    }","","}"],"type":"codeListing","syntax":"swift"},{"type":"aside","style":"important","name":"Important","content":[{"type":"paragraph","inlineContent":[{"text":"By default, instances of ","type":"text"},{"type":"reference","identifier":"doc:\/\/NetworkReachability\/documentation\/NetworkReachability\/NetworkMonitor","isActive":true},{"text":" always post their notifications on the main thread. You can change this behavior by setting the monitor’s ","type":"text"},{"code":".updateQueue","type":"codeVoice"},{"type":"text","text":" property."}]}]},{"text":"Combine","level":5,"type":"heading","anchor":"Combine"},{"inlineContent":[{"text":"You can observe network path changes using a ","type":"text"},{"identifier":"https:\/\/developer.apple.com\/documentation\/combine","isActive":true,"type":"reference"},{"text":" with the ","type":"text"},{"type":"codeVoice","code":"networkPathPublisher"},{"text":" static property.","type":"text"}],"type":"paragraph"},{"type":"codeListing","code":["import Combine","import Network","import NetworkReachability","","final class MyClass {","    ","    var monitorCancellable: AnyCancellable?","","    func startObserving() {","        stopObserving()","        monitorCancellable = NetworkMonitor.networkPathPublisher","            .map(\\.status)","            .sink { status in","                \/\/ Do something with `status`","            }","    }","","    func startObserving() {","        monitorCancellable?.cancel()","        monitorCancellable = nil","    }","","    deinit {","        monitorCancellable?.cancel()","    }","}"],"syntax":"swift"},{"content":[{"inlineContent":[{"text":"This API requires iOS 13, macOS 10.15, tvOS 13, or watchOS 6","type":"text"}],"type":"paragraph"}],"style":"note","type":"aside","name":"Note"}]}],"seeAlsoSections":[{"identifiers":["doc:\/\/NetworkReachability\/documentation\/NetworkReachability\/NetworkMonitor","doc:\/\/NetworkReachability\/documentation\/NetworkReachability\/NetworkMonitorDelegate"],"title":"Network Monitor","generated":true}],"schemaVersion":{"major":0,"patch":0,"minor":3},"hierarchy":{"paths":[["doc:\/\/NetworkReachability\/documentation\/NetworkReachability"]]},"identifier":{"url":"doc:\/\/NetworkReachability\/documentation\/NetworkReachability\/NetworkMonitorGuide","interfaceLanguage":"swift"},"kind":"article","metadata":{"modules":[{"name":"NetworkReachability"}],"role":"article","roleHeading":"Article","title":"Network Monitor Programming Guide"},"abstract":[{"text":"Learn how to use Network Monitor APIs","type":"text"}],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/networkreachability\/networkmonitorguide"]}],"sections":[],"references":{"doc://NetworkReachability/documentation/NetworkReachability":{"abstract":[{"text":"A Swift replacement for ","type":"text"},{"type":"codeVoice","code":"SCNetworkReachability"},{"type":"text","text":" & "},{"type":"codeVoice","code":"NWPathMonitor"},{"text":" with support for structured concurrency.","type":"text"}],"role":"collection","url":"\/documentation\/networkreachability","identifier":"doc:\/\/NetworkReachability\/documentation\/NetworkReachability","type":"topic","title":"NetworkReachability","kind":"symbol"},"doc://NetworkReachability/documentation/NetworkReachability/NetworkMonitorDelegate":{"url":"\/documentation\/networkreachability\/networkmonitordelegate","role":"symbol","fragments":[{"text":"protocol","kind":"keyword"},{"kind":"text","text":" "},{"text":"NetworkMonitorDelegate","kind":"identifier"}],"navigatorTitle":[{"text":"NetworkMonitorDelegate","kind":"identifier"}],"type":"topic","kind":"symbol","abstract":[{"type":"text","text":"A protocol used to observe network path changes from a "},{"isActive":true,"identifier":"doc:\/\/NetworkReachability\/documentation\/NetworkReachability\/NetworkMonitor","type":"reference"}],"title":"NetworkMonitorDelegate","identifier":"doc:\/\/NetworkReachability\/documentation\/NetworkReachability\/NetworkMonitorDelegate"},"https://developer.apple.com/documentation/combine":{"title":"Combine","url":"https:\/\/developer.apple.com\/documentation\/combine","identifier":"https:\/\/developer.apple.com\/documentation\/combine","type":"link","titleInlineContent":[{"text":"Combine","type":"text"}]},"doc://NetworkReachability/documentation/NetworkReachability/NetworkMonitor":{"role":"symbol","kind":"symbol","type":"topic","fragments":[{"kind":"keyword","text":"class"},{"text":" ","kind":"text"},{"text":"NetworkMonitor","kind":"identifier"}],"title":"NetworkMonitor","navigatorTitle":[{"kind":"identifier","text":"NetworkMonitor"}],"abstract":[{"type":"text","text":"A class used to observe network path changes"}],"url":"\/documentation\/networkreachability\/networkmonitor","identifier":"doc:\/\/NetworkReachability\/documentation\/NetworkReachability\/NetworkMonitor"}}}